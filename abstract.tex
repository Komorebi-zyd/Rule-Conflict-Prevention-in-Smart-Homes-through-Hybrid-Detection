\begin{abstract}
%	物联网驱动的智能家居日益普及，其很大程度上依赖于自动化规则（触发-条件-动作，TCA）。然而，多个规则的并发执行可能导致意外的交互，即规则冲突，从而带来重大的安全性和可用性风险。现有的冲突检测方法通常存在不完整性或高误报率的问题，而冲突解决策略可能缺乏个性化或引入新的问题。本文提出了一种新颖的框架，结合静态分析和运行时的动态验证，以有效地检测和解决智能家居中的规则冲突。在静态方面，我们引入了一种增强的TCAE模型，该模型结合了通道属性，以捕获不同家庭区域之间的直接和间接交互。形式化分析能够识别六种类型的潜在交互。然后，根据用户定义的实体安全配置评估这些潜在交互，从而减少误报。基于安全优先级，为每个已识别的冲突自动生成定制的冲突解决策略。在动态方面，规则事件监听器会监控规则执行事件并交付给断言验证模块验证。一旦检测到规则冲突，系统就会拦截默认规则的执行，并强制执行预定义的、定制的冲突解决策略，从而在冲突发生之前有效地防止冲突。我们使用包含多个区域的17条规则的模拟Home Assistant环境实施并评估了我们的系统。结果表明，与现有工具相比，检测效果更优越，成功识别了所有手动验证的冲突，包括其他工具遗漏的侧信道引起的冲突，同时显著降低了误报率。该系统能够自动生成可行的、定制的冲突解决策略，并表现出高效的性能，即使对于大型规则集，静态分析也能在几秒钟内完成，而动态开销仍保持在毫秒级别。我们的方法提供了一种全面、有效和个性化的解决方案来缓解规则冲突。
	The increasing adoption of IoT-driven smart homes relies heavily on automation rules (Trigger-Condition-Action, TCA) for convenience and comfort. However, the concurrent execution of multiple rules can lead to unintended interactions which called rule conflicts, posing significant safety and usability risks. Existing conflict detection methods often suffer from incompleteness or high false positives, while resolution approaches can lack personalization or introduce new problems. This paper proposes a novel framework combining static analysis and dynamic runtime verification to effectively detect and resolve rule conflicts in smart homes. Statically, we introduce an enhanced TCAE model incorporating channel attributes to capture both direct and indirect interactions across different home zones. Formal analysis can identifies six types of potential interactions. These potential interactions are then evaluated against user-defined entity safety configurations to pinpoint actual conflicts, reducing false positives. Customized resolution strategies are automatically generated for each identified conflict based on safety priorities. Dynamically, rule event listener monitors rule execution events when system is running. Upon detecting an imminent conflict, the system intercepts default rule execution and enforces the pre-defined, customized resolution strategy, effectively preventing the conflict before it manifests. We implemented and evaluated our system using a simulated Home Assistant environment with 17 rules across multiple zones. Results demonstrate superior detection effectiveness compared to existing tools, successfully identifying all manually verified conflicts, including subtle side-channel induced ones missed by others, while significantly reducing false positives. The system enables automated generation of viable, customized resolution strategies and exhibits efficient performance, with static analysis completing in seconds even for large rule sets and dynamic overhead remaining at the millisecond level. Our approach offers a comprehensive, effective, and personalized solution to mitigate rule conflicts.
\end{abstract}

